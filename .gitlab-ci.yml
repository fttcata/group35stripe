# GitLab CI/CD configuration
stages:
  - test

# Build test job - runs on all branches
build_test:
  stage: test
  script:
    - npm ci --legacy-peer-deps
    - npm run lint
    - npm run typecheck
    - STRIPE_SECRET_KEY=sk_test_placeholder NEXT_PUBLIC_SUPABASE_URL=https://placeholder.supabase.co NEXT_PUBLIC_SUPABASE_ANON_KEY=placeholder npm run build
  cache:
    key: ${CI_COMMIT_REF_SLUG}-protected
    paths:
      - node_modules/
      - .next/cache/
